[{"node":{"id":1,"type":"COMPUTE_NODE","host":{"host":"127.0.0.1","port":5688},"state":"RUNNING","parallelUnits":[{"workerNodeId":1},{"id":1,"workerNodeId":1},{"id":2,"workerNodeId":1},{"id":3,"workerNodeId":1}]},"actors":[{"actorId":1,"fragmentId":1,"nodes":{"operatorId":"9","input":[{"operatorId":"8","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[5,6,7,8],"upstreamFragmentId":2,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}}],"streamKey":[2],"identity":"StreamMaterialize { columns: [quantity, company, _row_id(hidden)], pk_columns: [_row_id] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"materialize":{"tableId":1002,"columnOrders":[{"orderType":"ASCENDING","index":2}],"table":{"id":1002,"name":"t","columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":2}],"tableType":"TABLE","distributionKey":[2],"streamKey":[2],"owner":1,"fragmentId":1,"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"NO_SHUFFLE","dispatcherId":"13","downstreamActorId":[13]}],"upstreamActorId":[5,6,7,8],"vnodeBitmap":{"compression":"NONE","body":"AP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"}},{"actorId":2,"fragmentId":1,"nodes":{"operatorId":"9","input":[{"operatorId":"8","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[5,6,7,8],"upstreamFragmentId":2,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}}],"streamKey":[2],"identity":"StreamMaterialize { columns: [quantity, company, _row_id(hidden)], pk_columns: [_row_id] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"materialize":{"tableId":1002,"columnOrders":[{"orderType":"ASCENDING","index":2}],"table":{"id":1002,"name":"t","columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":2}],"tableType":"TABLE","distributionKey":[2],"streamKey":[2],"owner":1,"fragmentId":1,"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"NO_SHUFFLE","dispatcherId":"14","downstreamActorId":[14]}],"upstreamActorId":[5,6,7,8],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAA//////////8AAAAAAAAAAAAAAAAAAAAA"}},{"actorId":3,"fragmentId":1,"nodes":{"operatorId":"9","input":[{"operatorId":"8","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[5,6,7,8],"upstreamFragmentId":2,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}}],"streamKey":[2],"identity":"StreamMaterialize { columns: [quantity, company, _row_id(hidden)], pk_columns: [_row_id] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"materialize":{"tableId":1002,"columnOrders":[{"orderType":"ASCENDING","index":2}],"table":{"id":1002,"name":"t","columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":2}],"tableType":"TABLE","distributionKey":[2],"streamKey":[2],"owner":1,"fragmentId":1,"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"NO_SHUFFLE","dispatcherId":"15","downstreamActorId":[15]}],"upstreamActorId":[5,6,7,8],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAD//////////wAAAAAAAAAA"}},{"actorId":4,"fragmentId":1,"nodes":{"operatorId":"9","input":[{"operatorId":"8","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[5,6,7,8],"upstreamFragmentId":2,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}}],"streamKey":[2],"identity":"StreamMaterialize { columns: [quantity, company, _row_id(hidden)], pk_columns: [_row_id] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"materialize":{"tableId":1002,"columnOrders":[{"orderType":"ASCENDING","index":2}],"table":{"id":1002,"name":"t","columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":2}],"tableType":"TABLE","distributionKey":[2],"streamKey":[2],"owner":1,"fragmentId":1,"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"NO_SHUFFLE","dispatcherId":"16","downstreamActorId":[16]}],"upstreamActorId":[5,6,7,8],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////"}},{"actorId":5,"fragmentId":2,"nodes":{"operatorId":"7","streamKey":[2],"identity":"StreamSource { source: \"t\", columns: [\"quantity\", \"company\", \"_row_id\"] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"source":{"sourceId":1001,"stateTable":{"id":1003,"name":"__internal_t_2_sourceinternaltable_1003","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"partition_id"}},{"columnDesc":{"columnType":{"typeName":"BYTEA","isNullable":true},"columnId":1,"name":"offset"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","owner":1,"fragmentId":2,"valueIndices":[0,1]},"rowIdIndex":{"index":"2"},"columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"_row_id"},"isHidden":true}],"pkColumnIds":[2],"info":{"tableSource":{}},"sourceName":"t"}},"dispatcher":[{"type":"HASH","columnIndices":[2],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[1,2,3,4]},"dispatcherId":"8","downstreamActorId":[1,2,3,4]}],"vnodeBitmap":{"compression":"NONE","body":"AP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"}},{"actorId":6,"fragmentId":2,"nodes":{"operatorId":"7","streamKey":[2],"identity":"StreamSource { source: \"t\", columns: [\"quantity\", \"company\", \"_row_id\"] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"source":{"sourceId":1001,"stateTable":{"id":1003,"name":"__internal_t_2_sourceinternaltable_1003","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"partition_id"}},{"columnDesc":{"columnType":{"typeName":"BYTEA","isNullable":true},"columnId":1,"name":"offset"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","owner":1,"fragmentId":2,"valueIndices":[0,1]},"rowIdIndex":{"index":"2"},"columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"_row_id"},"isHidden":true}],"pkColumnIds":[2],"info":{"tableSource":{}},"sourceName":"t"}},"dispatcher":[{"type":"HASH","columnIndices":[2],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[1,2,3,4]},"dispatcherId":"8","downstreamActorId":[1,2,3,4]}],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAA//////////8AAAAAAAAAAAAAAAAAAAAA"}},{"actorId":7,"fragmentId":2,"nodes":{"operatorId":"7","streamKey":[2],"identity":"StreamSource { source: \"t\", columns: [\"quantity\", \"company\", \"_row_id\"] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"source":{"sourceId":1001,"stateTable":{"id":1003,"name":"__internal_t_2_sourceinternaltable_1003","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"partition_id"}},{"columnDesc":{"columnType":{"typeName":"BYTEA","isNullable":true},"columnId":1,"name":"offset"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","owner":1,"fragmentId":2,"valueIndices":[0,1]},"rowIdIndex":{"index":"2"},"columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"_row_id"},"isHidden":true}],"pkColumnIds":[2],"info":{"tableSource":{}},"sourceName":"t"}},"dispatcher":[{"type":"HASH","columnIndices":[2],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[1,2,3,4]},"dispatcherId":"8","downstreamActorId":[1,2,3,4]}],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAD//////////wAAAAAAAAAA"}},{"actorId":8,"fragmentId":2,"nodes":{"operatorId":"7","streamKey":[2],"identity":"StreamSource { source: \"t\", columns: [\"quantity\", \"company\", \"_row_id\"] }","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"source":{"sourceId":1001,"stateTable":{"id":1003,"name":"__internal_t_2_sourceinternaltable_1003","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"partition_id"}},{"columnDesc":{"columnType":{"typeName":"BYTEA","isNullable":true},"columnId":1,"name":"offset"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","owner":1,"fragmentId":2,"valueIndices":[0,1]},"rowIdIndex":{"index":"2"},"columns":[{"columnDesc":{"columnType":{"typeName":"INT32","isNullable":true},"name":"quantity"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1,"name":"company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"_row_id"},"isHidden":true}],"pkColumnIds":[2],"info":{"tableSource":{}},"sourceName":"t"}},"dispatcher":[{"type":"HASH","columnIndices":[2],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[1,2,3,4]},"dispatcherId":"8","downstreamActorId":[1,2,3,4]}],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////"}},{"actorId":9,"fragmentId":3,"nodes":{"operatorId":"76","input":[{"operatorId":"75","input":[{"operatorId":"70","input":[{"operatorId":"68","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"merge":{"upstreamActorId":[13,14,15,16],"upstreamFragmentId":4,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}]}}],"streamKey":[0],"identity":"StreamHashAgg { group_key: [t.company], aggs: [count, sum(t.quantity)] }","fields":[{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"count"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"}],"hashAgg":{"groupKey":[1],"aggCalls":[{"type":"COUNT","returnType":{"typeName":"INT64","isNullable":true}},{"type":"SUM","args":[{"input":{},"type":{"typeName":"INT32","isNullable":true}}],"returnType":{"typeName":"INT64","isNullable":true}}],"aggCallStates":[{"resultValueState":{}},{"resultValueState":{}}],"resultTable":{"id":1005,"name":"__internal_mv1_3_hashaggresult_1005","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1,"name":"count"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"sum(t.quantity)"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","distributionKey":[0],"owner":1,"fragmentId":3,"valueIndices":[1,2],"readPrefixLenHint":1}}}],"streamKey":[1],"identity":"StreamProject { exprs: [sum(t.quantity), t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"project":{"selectList":[{"exprType":"INPUT_REF","returnType":{"typeName":"INT64","isNullable":true},"inputRef":{"columnIdx":2}},{"exprType":"INPUT_REF","returnType":{"typeName":"VARCHAR","isNullable":true},"inputRef":{}}]}}],"streamKey":[1],"identity":"StreamMaterialize { columns: [q, t.company(hidden)], pk_columns: [t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"materialize":{"tableId":1004,"columnOrders":[{"orderType":"ASCENDING","index":1}],"table":{"id":1004,"name":"mv1","columns":[{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1000,"name":"q"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"t.company"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":1}],"tableType":"MATERIALIZED_VIEW","distributionKey":[1],"streamKey":[1],"owner":1,"fragmentId":3,"valueIndices":[0,1],"definition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company","readPrefixLenHint":1}}},"upstreamActorId":[13,14,15,16],"vnodeBitmap":{"compression":"NONE","body":"AP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":10,"fragmentId":3,"nodes":{"operatorId":"76","input":[{"operatorId":"75","input":[{"operatorId":"70","input":[{"operatorId":"68","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"merge":{"upstreamActorId":[13,14,15,16],"upstreamFragmentId":4,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}]}}],"streamKey":[0],"identity":"StreamHashAgg { group_key: [t.company], aggs: [count, sum(t.quantity)] }","fields":[{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"count"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"}],"hashAgg":{"groupKey":[1],"aggCalls":[{"type":"COUNT","returnType":{"typeName":"INT64","isNullable":true}},{"type":"SUM","args":[{"input":{},"type":{"typeName":"INT32","isNullable":true}}],"returnType":{"typeName":"INT64","isNullable":true}}],"aggCallStates":[{"resultValueState":{}},{"resultValueState":{}}],"resultTable":{"id":1005,"name":"__internal_mv1_3_hashaggresult_1005","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1,"name":"count"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"sum(t.quantity)"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","distributionKey":[0],"owner":1,"fragmentId":3,"valueIndices":[1,2],"readPrefixLenHint":1}}}],"streamKey":[1],"identity":"StreamProject { exprs: [sum(t.quantity), t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"project":{"selectList":[{"exprType":"INPUT_REF","returnType":{"typeName":"INT64","isNullable":true},"inputRef":{"columnIdx":2}},{"exprType":"INPUT_REF","returnType":{"typeName":"VARCHAR","isNullable":true},"inputRef":{}}]}}],"streamKey":[1],"identity":"StreamMaterialize { columns: [q, t.company(hidden)], pk_columns: [t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"materialize":{"tableId":1004,"columnOrders":[{"orderType":"ASCENDING","index":1}],"table":{"id":1004,"name":"mv1","columns":[{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1000,"name":"q"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"t.company"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":1}],"tableType":"MATERIALIZED_VIEW","distributionKey":[1],"streamKey":[1],"owner":1,"fragmentId":3,"valueIndices":[0,1],"definition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company","readPrefixLenHint":1}}},"upstreamActorId":[13,14,15,16],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAA//////////8AAAAAAAAAAAAAAAAAAAAA"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":11,"fragmentId":3,"nodes":{"operatorId":"76","input":[{"operatorId":"75","input":[{"operatorId":"70","input":[{"operatorId":"68","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"merge":{"upstreamActorId":[13,14,15,16],"upstreamFragmentId":4,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}]}}],"streamKey":[0],"identity":"StreamHashAgg { group_key: [t.company], aggs: [count, sum(t.quantity)] }","fields":[{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"count"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"}],"hashAgg":{"groupKey":[1],"aggCalls":[{"type":"COUNT","returnType":{"typeName":"INT64","isNullable":true}},{"type":"SUM","args":[{"input":{},"type":{"typeName":"INT32","isNullable":true}}],"returnType":{"typeName":"INT64","isNullable":true}}],"aggCallStates":[{"resultValueState":{}},{"resultValueState":{}}],"resultTable":{"id":1005,"name":"__internal_mv1_3_hashaggresult_1005","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1,"name":"count"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"sum(t.quantity)"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","distributionKey":[0],"owner":1,"fragmentId":3,"valueIndices":[1,2],"readPrefixLenHint":1}}}],"streamKey":[1],"identity":"StreamProject { exprs: [sum(t.quantity), t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"project":{"selectList":[{"exprType":"INPUT_REF","returnType":{"typeName":"INT64","isNullable":true},"inputRef":{"columnIdx":2}},{"exprType":"INPUT_REF","returnType":{"typeName":"VARCHAR","isNullable":true},"inputRef":{}}]}}],"streamKey":[1],"identity":"StreamMaterialize { columns: [q, t.company(hidden)], pk_columns: [t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"materialize":{"tableId":1004,"columnOrders":[{"orderType":"ASCENDING","index":1}],"table":{"id":1004,"name":"mv1","columns":[{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1000,"name":"q"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"t.company"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":1}],"tableType":"MATERIALIZED_VIEW","distributionKey":[1],"streamKey":[1],"owner":1,"fragmentId":3,"valueIndices":[0,1],"definition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company","readPrefixLenHint":1}}},"upstreamActorId":[13,14,15,16],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAD//////////wAAAAAAAAAA"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":12,"fragmentId":3,"nodes":{"operatorId":"76","input":[{"operatorId":"75","input":[{"operatorId":"70","input":[{"operatorId":"68","streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"merge":{"upstreamActorId":[13,14,15,16],"upstreamFragmentId":4,"upstreamDispatcherType":"HASH","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}]}}],"streamKey":[0],"identity":"StreamHashAgg { group_key: [t.company], aggs: [count, sum(t.quantity)] }","fields":[{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"count"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"}],"hashAgg":{"groupKey":[1],"aggCalls":[{"type":"COUNT","returnType":{"typeName":"INT64","isNullable":true}},{"type":"SUM","args":[{"input":{},"type":{"typeName":"INT32","isNullable":true}}],"returnType":{"typeName":"INT64","isNullable":true}}],"aggCallStates":[{"resultValueState":{}},{"resultValueState":{}}],"resultTable":{"id":1005,"name":"__internal_mv1_3_hashaggresult_1005","columns":[{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1,"name":"count"}},{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":2,"name":"sum(t.quantity)"}}],"pk":[{"orderType":"ASCENDING"}],"tableType":"INTERNAL","distributionKey":[0],"owner":1,"fragmentId":3,"valueIndices":[1,2],"readPrefixLenHint":1}}}],"streamKey":[1],"identity":"StreamProject { exprs: [sum(t.quantity), t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"project":{"selectList":[{"exprType":"INPUT_REF","returnType":{"typeName":"INT64","isNullable":true},"inputRef":{"columnIdx":2}},{"exprType":"INPUT_REF","returnType":{"typeName":"VARCHAR","isNullable":true},"inputRef":{}}]}}],"streamKey":[1],"identity":"StreamMaterialize { columns: [q, t.company(hidden)], pk_columns: [t.company] }","fields":[{"dataType":{"typeName":"INT64","isNullable":true},"name":"sum(t.quantity)"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"}],"materialize":{"tableId":1004,"columnOrders":[{"orderType":"ASCENDING","index":1}],"table":{"id":1004,"name":"mv1","columns":[{"columnDesc":{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1000,"name":"q"}},{"columnDesc":{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"t.company"},"isHidden":true}],"pk":[{"orderType":"ASCENDING","index":1}],"tableType":"MATERIALIZED_VIEW","distributionKey":[1],"streamKey":[1],"owner":1,"fragmentId":3,"valueIndices":[0,1],"definition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company","readPrefixLenHint":1}}},"upstreamActorId":[13,14,15,16],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":13,"fragmentId":4,"nodes":{"operatorId":"67","input":[{"streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[1],"upstreamFragmentId":1,"upstreamDispatcherType":"NO_SHUFFLE","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}},{"operatorId":"66","streamKey":[2],"appendOnly":true,"identity":"BatchPlanNode","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"batchPlan":{"tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1},"columnIds":[1000,1001,1002]}}],"streamKey":[2],"identity":"ChainExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"chain":{"tableId":1002,"upstreamFields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"upstreamColumnIndices":[0,1,2],"chainType":"BACKFILL","tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"HASH","columnIndices":[1],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[9,10,11,12]},"dispatcherId":"68","downstreamActorId":[9,10,11,12]}],"upstreamActorId":[1],"vnodeBitmap":{"compression":"NONE","body":"AP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":14,"fragmentId":4,"nodes":{"operatorId":"67","input":[{"streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[2],"upstreamFragmentId":1,"upstreamDispatcherType":"NO_SHUFFLE","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}},{"operatorId":"66","streamKey":[2],"appendOnly":true,"identity":"BatchPlanNode","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"batchPlan":{"tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1},"columnIds":[1000,1001,1002]}}],"streamKey":[2],"identity":"ChainExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"chain":{"tableId":1002,"upstreamFields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"upstreamColumnIndices":[0,1,2],"chainType":"BACKFILL","tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"HASH","columnIndices":[1],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[9,10,11,12]},"dispatcherId":"68","downstreamActorId":[9,10,11,12]}],"upstreamActorId":[2],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAA//////////8AAAAAAAAAAAAAAAAAAAAA"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":15,"fragmentId":4,"nodes":{"operatorId":"67","input":[{"streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[3],"upstreamFragmentId":1,"upstreamDispatcherType":"NO_SHUFFLE","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}},{"operatorId":"66","streamKey":[2],"appendOnly":true,"identity":"BatchPlanNode","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"batchPlan":{"tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1},"columnIds":[1000,1001,1002]}}],"streamKey":[2],"identity":"ChainExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"chain":{"tableId":1002,"upstreamFields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"upstreamColumnIndices":[0,1,2],"chainType":"BACKFILL","tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"HASH","columnIndices":[1],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[9,10,11,12]},"dispatcherId":"68","downstreamActorId":[9,10,11,12]}],"upstreamActorId":[3],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAD//////////wAAAAAAAAAA"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"},{"actorId":16,"fragmentId":4,"nodes":{"operatorId":"67","input":[{"streamKey":[2],"identity":"MergeExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"merge":{"upstreamActorId":[4],"upstreamFragmentId":1,"upstreamDispatcherType":"NO_SHUFFLE","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}]}},{"operatorId":"66","streamKey":[2],"appendOnly":true,"identity":"BatchPlanNode","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"t.quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"t.company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"t._row_id"}],"batchPlan":{"tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1},"columnIds":[1000,1001,1002]}}],"streamKey":[2],"identity":"ChainExecutor","fields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"chain":{"tableId":1002,"upstreamFields":[{"dataType":{"typeName":"INT32","isNullable":true},"name":"quantity"},{"dataType":{"typeName":"VARCHAR","isNullable":true},"name":"company"},{"dataType":{"typeName":"INT64","isNullable":true},"name":"_row_id"}],"upstreamColumnIndices":[0,1,2],"chainType":"BACKFILL","tableDesc":{"tableId":1002,"columns":[{"columnType":{"typeName":"INT32","isNullable":true},"columnId":1000,"name":"quantity"},{"columnType":{"typeName":"VARCHAR","isNullable":true},"columnId":1001,"name":"company"},{"columnType":{"typeName":"INT64","isNullable":true},"columnId":1002,"name":"_row_id"}],"pk":[{"orderType":"ASCENDING","index":2}],"distKeyIndices":[2],"valueIndices":[0,1,2],"readPrefixLenHint":1}}},"dispatcher":[{"type":"HASH","columnIndices":[1],"hashMapping":{"originalIndices":["63","127","191","255"],"data":[9,10,11,12]},"dispatcherId":"68","downstreamActorId":[9,10,11,12]}],"upstreamActorId":[4],"vnodeBitmap":{"compression":"NONE","body":"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////"},"mviewDefinition":"SELECT SUM(t.quantity) AS q FROM t GROUP BY t.company"}]}]