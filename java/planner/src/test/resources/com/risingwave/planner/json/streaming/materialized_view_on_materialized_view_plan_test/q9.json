{
  "input": [{
    "pkIndices": [2, 3, 4, 5],
    "input": [{
      "pkIndices": [0, 1, 2, 3],
      "input": [{
        "input": [{
          "mergeNode": {
          }
        }, {
          "batchPlanNode": {
            "tableRefId": {
              "schemaRefId": {
                "databaseRefId": {
                }
              },
              "tableId": 9
            },
            "pkIndices": [2],
            "columnIds": [0, 1, 3]
          },
          "identity": "RwStreamBatchPlan(table\u003d[[test_schema, m8]], tableId\u003d[0.0.9], primaryKeyIndices\u003d[[2]], columnIds\u003d[[0.0.9.0, 0.0.9.1, 0.0.9.3]])"
        }],
        "chainNode": {
          "tableRefId": {
            "schemaRefId": {
              "databaseRefId": {
              }
            },
            "tableId": 9
          },
          "upstreamColumnDescs": [{
            "columnType": {
              "typeName": "FLOAT"
            }
          }, {
            "columnType": {
              "typeName": "INT32"
            }
          }, {
            "columnType": {
              "typeName": "FLOAT"
            }
          }, {
            "columnType": {
              "typeName": "INT64"
            }
          }],
          "pkIndices": [2],
          "columnIds": [0, 1, 3]
        },
        "identity": "RwStreamChain(all\u003d[true], tableId\u003d[0.0.9], primaryKeyIndices\u003d[[2]], columnIds\u003d[[0.0.9.0, 0.0.9.1, 0.0.9.3]], upstreamColumnDescs\u003d[[ColumnDesc{dataType\u003dFLOAT, primary\u003dfalse}, ColumnDesc{dataType\u003dINTEGER, primary\u003dfalse}, ColumnDesc{dataType\u003dFLOAT, primary\u003dfalse}, ColumnDesc{dataType\u003dBIGINT, primary\u003dfalse}]])"
      }],
      "globalSimpleAggNode": {
        "aggCalls": [{
          "type": "COUNT",
          "returnType": {
            "typeName": "INT64"
          }
        }, {
          "type": "SUM",
          "args": [{
            "input": {
            },
            "type": {
              "typeName": "FLOAT"
            }
          }],
          "returnType": {
            "typeName": "FLOAT"
          }
        }, {
          "type": "COUNT",
          "args": [{
            "input": {
            },
            "type": {
              "typeName": "FLOAT"
            }
          }],
          "returnType": {
            "typeName": "INT64"
          }
        }, {
          "type": "SUM",
          "args": [{
            "input": {
              "columnIdx": 1
            },
            "type": {
              "typeName": "INT32"
            }
          }],
          "returnType": {
            "typeName": "INT64"
          }
        }]
      }
    }],
    "projectNode": {
      "selectList": [{
        "exprType": "ROUND_DIGIT",
        "returnType": {
          "typeName": "DOUBLE"
        },
        "funcCall": {
          "children": [{
            "exprType": "STREAM_NULL_BY_ROW_COUNT",
            "returnType": {
              "typeName": "DOUBLE"
            },
            "funcCall": {
              "children": [{
                "exprType": "INPUT_REF",
                "returnType": {
                  "typeName": "INT64"
                },
                "inputRef": {
                }
              }, {
                "exprType": "DIVIDE",
                "returnType": {
                  "typeName": "DOUBLE"
                },
                "funcCall": {
                  "children": [{
                    "exprType": "CAST",
                    "returnType": {
                      "typeName": "DOUBLE"
                    },
                    "funcCall": {
                      "children": [{
                        "exprType": "INPUT_REF",
                        "returnType": {
                          "typeName": "FLOAT"
                        },
                        "inputRef": {
                          "columnIdx": 1
                        }
                      }]
                    }
                  }, {
                    "exprType": "INPUT_REF",
                    "returnType": {
                      "typeName": "INT64"
                    },
                    "inputRef": {
                      "columnIdx": 2
                    }
                  }]
                }
              }]
            }
          }, {
            "exprType": "CONSTANT_VALUE",
            "returnType": {
              "typeName": "INT32"
            },
            "constant": {
              "body": "AAAAAQ=="
            }
          }]
        }
      }, {
        "exprType": "STREAM_NULL_BY_ROW_COUNT",
        "returnType": {
          "typeName": "INT64"
        },
        "funcCall": {
          "children": [{
            "exprType": "INPUT_REF",
            "returnType": {
              "typeName": "INT64"
            },
            "inputRef": {
            }
          }, {
            "exprType": "INPUT_REF",
            "returnType": {
              "typeName": "INT64"
            },
            "inputRef": {
              "columnIdx": 3
            }
          }]
        }
      }, {
        "exprType": "INPUT_REF",
        "returnType": {
          "typeName": "INT64"
        },
        "inputRef": {
        }
      }, {
        "exprType": "INPUT_REF",
        "returnType": {
          "typeName": "FLOAT"
        },
        "inputRef": {
          "columnIdx": 1
        }
      }, {
        "exprType": "INPUT_REF",
        "returnType": {
          "typeName": "INT64"
        },
        "inputRef": {
          "columnIdx": 2
        }
      }, {
        "exprType": "INPUT_REF",
        "returnType": {
          "typeName": "INT64"
        },
        "inputRef": {
          "columnIdx": 3
        }
      }]
    },
    "identity": "RwStreamProject(avg_v1\u003d[ROUND($STREAM_NULL_BY_ROW_COUNT($0, /(CAST($1):DOUBLE, $2)), 1)], sum_v2\u003d[$STREAM_NULL_BY_ROW_COUNT($0, $3)], count_v3\u003d[$0], $f1\u003d[$1], $f2\u003d[$2], sum_v2_copy\u003d[$3])"
  }],
  "mviewNode": {
    "tableRefId": {
      "schemaRefId": {
        "databaseRefId": {
        }
      },
      "tableId": 10
    },
    "columnDescs": [{
      "columnType": {
        "typeName": "DOUBLE"
      },
      "encoding": "RAW",
      "name": "avg_v1"
    }, {
      "columnType": {
        "typeName": "INT64"
      },
      "encoding": "RAW",
      "name": "sum_v2"
    }, {
      "columnType": {
        "typeName": "INT64"
      },
      "encoding": "RAW",
      "name": "count_v3"
    }, {
      "columnType": {
        "typeName": "FLOAT"
      },
      "encoding": "RAW",
      "name": "$f1"
    }, {
      "columnType": {
        "typeName": "INT64"
      },
      "encoding": "RAW",
      "name": "$f2"
    }, {
      "columnType": {
        "typeName": "INT64"
      },
      "encoding": "RAW",
      "name": "sum_v2_copy"
    }],
    "pkIndices": [2, 3, 4, 5],
    "columnOrders": [{
      "orderType": "ASCENDING",
      "inputRef": {
        "columnIdx": 2
      },
      "returnType": {
        "typeName": "INT64"
      }
    }, {
      "orderType": "ASCENDING",
      "inputRef": {
        "columnIdx": 3
      },
      "returnType": {
        "typeName": "FLOAT"
      }
    }, {
      "orderType": "ASCENDING",
      "inputRef": {
        "columnIdx": 4
      },
      "returnType": {
        "typeName": "INT64"
      }
    }, {
      "orderType": "ASCENDING",
      "inputRef": {
        "columnIdx": 5
      },
      "returnType": {
        "typeName": "INT64"
      }
    }]
  },
  "identity": "RwStreamMaterializedView(name\u003d[m9])"
}