- sql: |
    create table t1 (id int, v1 int);
    create table t2 (id int, v2 int);
    SELECT Tone.max_v1, Ttwo.max_v2
    FROM (
        SELECT
            max(v1) as max_v1, id
        FROM t1
        GROUP BY
            id
        ) AS Tone
    JOIN (
        SELECT
            max(v2) as max_v2, id
        FROM t2
        GROUP BY
            id
        ) AS Ttwo
    ON
        Tone.id = Ttwo.id;
  stream_plan: |
    StreamMaterialize { columns: [max_v1, max_v2, t1#id(hidden), t2#id(hidden)], pk_columns: [t1#id, t2#id] }
      StreamProject { exprs: [$0, $2, $1, $3] }
        StreamHashJoin { type: Inner, predicate: $1 = $3 }
          StreamProject { exprs: [$2, $0] }
            StreamHashAgg { group_keys: [$0], aggs: [count, max($1)] }
              StreamExchange { dist: HashShard([0]) }
                StreamTableScan { table: t1, columns: [t1#id, t1#v1, t1#_row_id#0], pk_indices: [2] }
          StreamProject { exprs: [$2, $0] }
            StreamHashAgg { group_keys: [$0], aggs: [count, max($1)] }
              StreamExchange { dist: HashShard([0]) }
                StreamTableScan { table: t2, columns: [t2#id, t2#v2, t2#_row_id#0], pk_indices: [2] }
