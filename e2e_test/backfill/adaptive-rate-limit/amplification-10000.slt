statement ok
set streaming_parallelism = 2;

statement ok
create table fact(v1 int);

statement ok
create table dim(v1 int);

# Total backfill = 50_000 * 100 = 5M records

statement ok
insert into fact select v from generate_series(1, 100000) as v ;

statement ok
insert into dim select v from generate_series(1, 1000) as v, generate_series(1, 10000);

statement ok
flush;

statement ok
set background_ddl = false;

statement ok
set BACKFILL_RATE_LIMIT = 0;

statement ok
create materialized view m1 as select fact.v1 from fact join dim on fact.v1 = dim.v1;

statement ok
flush;
