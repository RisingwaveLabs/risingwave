# This file is generated by `gen.py`. Do not edit it manually!

# Test window functions together with filters.
# https://github.com/risingwavelabs/risingwave/issues/13653

statement ok
create table t (id int, cat varchar, rule varchar, at timestamptz);

statement ok
insert into t values
  (1, 'foo', 'A', '2023-11-23T12:00:42Z')
, (2, 'foo', 'B', '2023-11-23T12:01:15Z');

query TT
select rule, lag(rule) over (partition by cat order by at) from t where rule = 'B';
----
B  NULL

query TT
select * from (select rule, lag(rule) over (partition by cat order by at) as prev_rule from t) where rule = 'B';
----
B  A

query TT
select * from (select rule, at, row_number() over (partition by cat order by at) as rank from t) where at = '2023-11-23T12:01:15Z'::timestamptz;
----
B  2023-11-23 12:01:15+00:00  2
