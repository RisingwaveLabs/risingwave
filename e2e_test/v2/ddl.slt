# Create a table.
statement ok
create table ddl_t (v1 int not null);

statement ok
explain select v1 from ddl_t;

# Create another table with duplicated name.
statement error
create table ddl_t (v2 int not null);

# Drop the table.
statement ok
drop table ddl_t;

# Drop it again.
statement error
drop table ddl_t;

# Create another table with the same name.
statement ok
create table ddl_t (v2 int not null);

statement ok
explain select v2 from ddl_t;

# Create a mview on top of it.
statement ok
create materialized view ddl_mv as select v2 from ddl_t;

statement ok
explain select v2 from ddl_t;

# Create a mview with duplicated name.
statement error
create materialized view ddl_mv as select v2 from ddl_t;

# Drop the table before dropping the mview.
statement error
drop table ddl_t;

# TODO: enable this after dropping MV is implemented.

# # Drop the mview.
# statement ok;
# drop materialized view ddl_mv;

# # Drop it again.
# statement error
# drop materialized view ddl_mv;

# # Then, we can drop the base table.
# statement ok
# drop table ddl_t;
