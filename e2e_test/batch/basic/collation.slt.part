statement ok
SET RW_IMPLICIT_FLUSH TO true;

# collate in select

query T
select 'a' collate "C";
----
a

query B
select 'a' < 'b' collate "C";
----
t

query B
select 'b' < 'a' collate "POSIX";
----
f

query T
select (varchar 't') collate "C";
----
t

query T
select 'a' collate "c";
----
a

query T
select 'a' collate "c";
----
a

query T
select 'a' collate "posix";
----
a

query T
select 'a' collate "pOsIx";
----
a

query BT
select 'a' < 'b', 'a' collate "C";
----
t a

query B
select 'a' < ('b' collate "C");
----
t

query B
select ('a' < 'b') collate "C";
----
t

# parser issue
statement error
select varchar 't' collate "C";

# collate in create table

statement ok
create table t1 (
  a text collate "C",
  b int
);

statement ok
create table t2 (
  a text collate "POSIX",
  b int
);

statement ok
create table t3 (
  a text collate "pOsIx",
  b int
);

# PostgreSQL raise error that collate cannot apply to type `int`
statement ok
create table t4 (
  a text collate "POSIX",
  b int collate "C"
);

statement ok
drop table t1;

statement ok
drop table t2;

statement ok
drop table t3;

statement ok
drop table t4;
