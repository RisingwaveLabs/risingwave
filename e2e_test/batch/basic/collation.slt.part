statement ok
SET RW_IMPLICIT_FLUSH TO true;

# collate in select

query T
select 'a' collate "C";
----
a

query B
select 'a' < 'b' collate "C";
----
t

query B
select 'b' < 'a' collate "POSIX";
----
f

query T
select (varchar 't') collate "C";
----
t

# case-sensitive
statement error
select 'a' collate "c";

# case-sensitive
statement error
select 'a' collate "posix";

# case-sensitive
statement error
select 'a' collate "pOsIx";

query BT
select 'a' < 'b', 'a' collate "C";
----
t a

query B
select 'a' < ('b' collate "C");
----
t

# only `text`, 'varchar' and `char` are built-in collatable types (in PostgreSQL)
# the type of `('a' < 'b')` is Bool, it SHOULD be failed,
# but we don't support real collation, we simply ignore it, so it WOULD be succeed.
#
# This is not a correct behavior
# and is expected to be corrected in the future when collation is truly supported.

# statement error
# select ('a' < 'b') collate "C";

# parser issue
statement error
select varchar 't' collate "C";

statement error
select 'a' collate "Invalid";

# collate in create table

statement ok
create table t1 (
  a text collate "C",
  b int
);

statement ok
create table t2 (
  a text collate "POSIX",
  b int
);

statement error
create table t3 (
  a text collate "pOsIx",
  b int
);

# PostgreSQL raise error that collate cannot apply to type `int`
statement ok
create table t4 (
  a text collate "POSIX",
  b int collate "C"
);

statement ok
drop table t1;

statement ok
drop table t2;

statement ok
drop table t4;
