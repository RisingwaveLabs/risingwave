# ERROR:  QueryError: Feature is not yet implemented: unsupported function: "mod"
query ITTTR rowsort
with	 revenue (supplier_no, total_revenue) as (
         select	mod((s_w_id * s_i_id),10000) as supplier_no,
                sum(ol_amount) as total_revenue
         from	orderline, stock
                where ol_i_id = s_i_id and ol_supply_w_id = s_w_id
                and ol_delivery_d >= '2007-01-02 00:00:00.000000'
         group by mod((s_w_id * s_i_id),10000))
select	 s_suppkey, s_name, s_address, s_phone, total_revenue
from	 supplier, revenue
where	 s_suppkey = supplier_no
    	 and total_revenue = (select max(total_revenue) from revenue)
order by s_suppkey;
