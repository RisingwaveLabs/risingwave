statement ok
SET RW_IMPLICIT_FLUSH TO true;

statement ok
create table t1(v1 int, v2 timestamp);

statement ok
insert into t1 values(1,'2013-01-01 01:01:01.123456789'),(2,'2012-01-01 01:01:01.123456'),(3,'0000-01-01 01:01:01.123456789'),(4,'2213-01-01 01:01:01.123456789'),(5,null);

query T rowsort
select * from t1;
----
1  2013-01-01 01:01:01.123456789
2  2012-01-01 01:01:01.123456
3  0001-01-01 01:01:01.123456789 BC
4  2213-01-01 01:01:01.123456789
5  NULL

query T
select * from t1 where v2 is null;
----
5 NULL

query T rowsort
select v1, v2,
case
    when extract(year from v2) < 2000 then 'Before 2000'
    when extract(year from v2) >= 2000 and extract(year from v2) < 2100 then '21st Century'
    else 'Future'
end as time_period
from t1;
----
1  2013-01-01 01:01:01.123456789     21st Century
2  2012-01-01 01:01:01.123456        21st Century
3  0001-01-01 01:01:01.123456789 BC  Before 2000
4  2213-01-01 01:01:01.123456789     Future
5  NULL                              Future

query T rowsort
select v1, v2, coalesce(v2, '1900-01-01 00:00:00') as coalesce_v2 from t1;
----
1  2013-01-01 01:01:01.123456789     2013-01-01 01:01:01.123456789
2  2012-01-01 01:01:01.123456        2012-01-01 01:01:01.123456
3  0001-01-01 01:01:01.123456789 BC  0001-01-01 01:01:01.123456789 BC
4  2213-01-01 01:01:01.123456789     2213-01-01 01:01:01.123456789
5  NULL                              1900-01-01 00:00:00

query T
select count(v2) as total_rows from t1;
----
4

query T rowsort
select * from t1 order by v2;
----
1  2013-01-01 01:01:01.123456789
2  2012-01-01 01:01:01.123456
3  0001-01-01 01:01:01.123456789 BC
4  2213-01-01 01:01:01.123456789
5  NULL

query T rowsort
select * from t1 where v2 >= '2012-01-01 01:01:01.123456';
----
1  2013-01-01 01:01:01.123456789
2  2012-01-01 01:01:01.123456
4  2213-01-01 01:01:01.123456789

query T rowsort
select v1, cast(v2 as date) as date_v2, cast(v2 as timestamp with time zone) as timestamptz_v2 from t1;
----
1  2013-01-01     2013-01-01 01:01:01.123456+00:00
2  2012-01-01     2012-01-01 01:01:01.123456+00:00
3  0001-01-01 BC  0001-01-01 01:01:01.123456+00:00 BC
4  2213-01-01     2213-01-01 01:01:01.123456+00:00
5  NULL           NULL

query T rowsort
select v1, date_trunc('day', v2) AS truncated_v2 from t1;
----
1  2013-01-01 00:00:00
2  2012-01-01 00:00:00
3  0001-01-01 00:00:00 BC
4  2213-01-01 00:00:00
5  NULL

query T rowsort
select v1, v2 at time zone 'UTC' as v2_utc from t1;
----
1  2013-01-01 01:01:01.123456+00:00
2  2012-01-01 01:01:01.123456+00:00
3  0001-01-01 01:01:01.123456+00:00 BC
4  2213-01-01 01:01:01.123456+00:00
5  NULL

query T rowsort
select v1, to_char(v2, 'YYYY-MM-DD HH24:MI:SS.NS') as formatted_v2 from t1;
----
1  2013-01-01 01:01:01.123456789
2  2012-01-01 01:01:01.123456000
3  0000-01-01 01:01:01.123456789
4  2213-01-01 01:01:01.123456789
5  NULL

query T rowsort
select generate_series('2013-01-01 01:01:01.123456789'::timestamp,'2013-01-01 01:01:05.123456790'::timestamp, '1 s');
----
2013-01-01 01:01:01.123456789
2013-01-01 01:01:02.123456789
2013-01-01 01:01:03.123456789
2013-01-01 01:01:04.123456789
2013-01-01 01:01:05.123456789