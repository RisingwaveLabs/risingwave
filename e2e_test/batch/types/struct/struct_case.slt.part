# constant case
query I
SELECT CASE WHEN 1=1 THEN ROW(1) ELSE ROW(2) END
----
(1)

query I
SELECT CASE WHEN 1=0 THEN ROW(1) ELSE ROW(2) END
----
(2)

# null values
query I
SELECT CASE WHEN 1=1 THEN NULL ELSE ROW(2) END
----
NULL

query I
SELECT CASE WHEN 1=0 THEN NULL ELSE ROW(NULL) END
----
(NULL)

# now with a table
query II
select i, CASE WHEN i%2=0 THEN (1) ELSE (2) END from (SELECT generate_series as i FROM generate_series(1,6,1));
----
0	(1)
1	(2)
2	(1)
3	(2)
4	(1)
5	(2)

# strings
query II
select i, CASE WHEN i%2=0 THEN ('hello') ELSE ('world') END from (SELECT generate_series as i FROM generate_series(1,6,1));
----
0	('hello')
1	('world')
2	('hello')
3	('world')
4	('hello')
5	('world')

# nested structs
query II
SELECT i, CASE WHEN i%2=0 THEN ('hello', (3, NULL)) ELSE ('world', (7, 22)) END FROM (SELECT generate_series as i FROM generate_series(1,6,1));
----
0	('hello', (3, NULL))
1	('world', (7, 22))
2	('hello', (3, NULL))
3	('world', (7, 22))
4	('hello', (3, NULL))
5	('world', (7, 22))

# lists in structs
query II
SELECT i, CASE WHEN i%2=0 THEN ([1,2,3]) ELSE ([7,8]) END FROM (SELECT generate_series as i FROM generate_series(1,6,1));
----
0	([1,2,3])
1	([7,8])
2	([1,2,3])
3	([7,8])
4	([1,2,3])
5	([7,8])

# null values
query II
SELECT i, CASE WHEN i%2=0 THEN {'i': [1,2,3]} ELSE NULL END FROM range(6) tbl(i)
----
0	{'i': [1, 2, 3]}
1	NULL
2	{'i': [1, 2, 3]}
3	NULL
4	{'i': [1, 2, 3]}
5	NULL

query II
SELECT i, CASE WHEN i%2=0 THEN {'i': [1,2,3]} ELSE {'i': NULL} END FROM range(6) tbl(i)
----
0	{'i': [1, 2, 3]}
1	{'i': NULL}
2	{'i': [1, 2, 3]}
3	{'i': NULL}
4	{'i': [1, 2, 3]}
5	{'i': NULL}

# different types on child lists
query II
SELECT i, CASE WHEN i%2=0 THEN {'i': [1,2,3]} ELSE {'i': ['hello']} END FROM range(6) tbl(i)
----
0	{'i': [1, 2, 3]}
1	{'i': [hello]}
2	{'i': [1, 2, 3]}
3	{'i': [hello]}
4	{'i': [1, 2, 3]}
5	{'i': [hello]}