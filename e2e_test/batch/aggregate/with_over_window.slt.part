statement ok
create table t (a int, b int);

statement ok
insert into t values
    (1, 39),
    (1, 95),
    (2, 48),
    (3, 87),
    (4, 19),
    (4, 78),
    (4, 53);

query II
select
    a,
    sum((sum(b))) over (partition by a order by a)
from t
group by a;
----
1 134
2 48
3 87
4 150

query II
select
    a,
    row_number() over (partition by a order by a)
from t
group by a;
----
1 1
2 1
3 1
4 1

query II
select
    a,
    row_number() over (partition by a order by a desc)
from t
group by a;
----
1 1
2 1
3 1
4 1

statement ok
drop table t;
