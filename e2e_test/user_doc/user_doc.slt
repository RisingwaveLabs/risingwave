# examples in Get started

statement ok
CREATE TABLE taxi_trips(
    id VARCHAR,
    distance DOUBLE PRECISION,
    duration DOUBLE PRECISION
);

statement ok
INSERT INTO taxi_trips
VALUES
    ('1', 4, 10);

statement ok
CREATE MATERIALIZED VIEW mv_avg_speed
AS
    SELECT COUNT(id) as no_of_trips,
    SUM(distance) as total_distance,
    SUM(duration) as total_duration,
    SUM(distance) / SUM(duration) as avg_speed
    FROM taxi_trips;



statement ok
SELECT * FROM mv_avg_speed;

statement ok
INSERT INTO taxi_trips
VALUES
    ('2', 6, 10);

statement ok
SELECT * FROM mv_avg_speed;

statement ok
drop materialized view mv_avg_speed;

statement ok
drop table taxi_trips;


# Examples in â€œTime window functions"

statement ok
create table taxi_trips (trip_id int, taxi_id int, completed_at timestamp, distance double precision);

statement ok 
insert into taxi_trips values (1, 1001, '2022-07-01 22:00:00', 4), (2, 1002, '2022-07-01 22:01:00', 6), (3, 1003, '2022-07-01 22:02:00	', 3);

statement ok
SELECT trip_id,  taxi_id, completed_at, window_start, window_end
FROM TUMBLE (taxi_trips, completed_at, INTERVAL '2 MINUTES');

statement ok
SELECT trip_id, taxi_id, completed_at, window_start, window_end
FROM HOP (taxi_trips, completed_at, INTERVAL '1 MINUTE', INTERVAL '2 MINUTES')
ORDER BY window_start;

statement ok
drop table taxi_trips;

# Examples in "Array"

statement ok
CREATE TABLE taxi (
        taxi_id VARCHAR,
        trip_id VARCHAR[],
        plate VARCHAR,
        company VARCHAR,
        license_expiration_date DATE,
        licensed_to VARCHAR
    );

statement ok
INSERT INTO taxi VALUES
        (
            'FAST0001',
            ARRAY['ABCD1234', 'ABCD1235', 'ABCD1236', 'ABCD1237'],
            'N5432N', 
            'FAST TAXI', 
            '2030-12-31', 
            'DAVID WANG'
        );

statement ok
SELECT trip_id[1] 
FROM taxi;

statement ok
SELECT unnest(array[1,2,3,4]);

statement ok
drop table taxi;

# Examples in "Struct"

statement ok
CREATE TABLE x (a struct <b integer, c integer>, d integer);

statement ok
CREATE TABLE y (a struct <b struct<c integer>, d integer>, e varchar);

statement ok
CREATE TABLE trip (
        id VARCHAR,
        started_at TIMESTAMP,
        completed_at TIMESTAMP,
        distance DOUBLE PRECISION,
        fare STRUCT <
            initial_charge DOUBLE PRECISION,
            subsequent_charge DOUBLE PRECISION,
            surcharge DOUBLE PRECISION,
            tolls DOUBLE PRECISION 
            > 
        );

statement ok
INSERT INTO x VALUES (ROW(3, 4), 5);

statement ok
INSERT INTO y VALUES (ROW(ROW(6), 7), 8);

statement ok
SELECT (a).b, d FROM x;

statement ok
SELECT ((a).b).c, e FROM y;

statement ok
SELECT id, (fare).initial_charge FROM trip;


statement ok
INSERT INTO trip VALUES 
        (
            '1234ABCD', 
            '2022-07-28 11:04:05', 
            '2022-07-28 11:15:22', 
            6.1, 
            ROW(1.0, 4.0, 1.5, 2.0)
        );

statement ok
SELECT id, (fare).initial_charge 
FROM trip;

statement ok
SELECT (1, (2, 3))::STRUCT<i BIGINT, j STRUCT<a BIGINT, b VARCHAR>>;

statement ok
SELECT ROW(1, ROW('1', 1)) = ROW('1', ROW(1, '1'));

statement ok
drop table x, y, trip;



