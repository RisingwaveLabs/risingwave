statement ok
create table t (v boolean);

statement ok
create materialized view mv as select
    bool_and(v),
    bool_or(v)
from t;

query BB
select * from mv;
----
NULL NULL


statement ok
insert into t values (true);

statement ok
flush;

# t: true

query BB
select * from mv;
----
t t


statement ok
insert into t values (false);

statement ok
flush;

# t: true, false

query BB
select * from mv;
----
f t


statement ok
delete from t where v = true;

statement ok
flush;

# t: false

query BB
select * from mv;
----
f f


statement ok
delete from t;

statement ok
flush;

# t: empty

query BB
select * from mv;
----
NULL NULL


statement ok
drop materialized view mv;

statement ok
drop table t;
