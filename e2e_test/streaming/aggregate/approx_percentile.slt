# Single phase approx percentile
statement ok
create table t(p_col double, grp_col int);

statement ok
insert into t select generate_series, 1 from generate_series(1, 1000);

statement ok
flush;

query I
 select
     approx_percentile(0.5, 0.01) within group (order by p_col) as p50,
     approx_percentile(0.9, 0.01) within group (order by p_col) as p90
 from t group by grp_col;
----
502.8074762179866 916.1932801755476

statement ok
create materialized view m1 as
 select
     approx_percentile(0.5, 0.01) within group (order by p_col) as p50,
     approx_percentile(0.9, 0.01) within group (order by p_col) as p90
 from t group by grp_col;

query I
select * from m1;
----
502.8074762179866 916.1932801755476