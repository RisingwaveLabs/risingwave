statement ok
create table t4 (id integer primary key, name varchar);

statement ok
create materialized view mv4 as select * from t4;

statement ok
CREATE SINK s2 FROM mv4 WITH (
    connector='jdbc',
    jdbc.url='jdbc:postgresql://localhost:5432/test?user=test&password=connector',
    table.name='t4'
);

statement ok
INSERT INTO t4 VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Carl');

statement ok
INSERT INTO t4 VALUES (4, 'Doris'), (5, 'Eve'), (6, 'Frank');

statement ok
FLUSH;

statement ok
UPDATE t4 SET name = 'Alex' WHERE id = 1;

statement ok
DELETE FROM t4 WHERE id = 2;

statement ok
FLUSH;

statement ok
DROP SINK s2;

statement ok
DROP MATERIALIZED VIEW mv4;

statement ok
DROP TABLE t4;

statement ok
FLUSH;
