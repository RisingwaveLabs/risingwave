statement ok
create table t (v1 int, v2 varchar);

statement ok
create materialized view mv as select * from t

statement ok
create sink si from mv with ( kafka.brokers = '127.0.0.1:29092', kafka.topic = 'sink_debezium', format = 'debezium', connector = 'kafka' )

statement ok
create materialized source s (v1 int, v2 varchar, primary key (v1) ) with (kafka.brokers = '127.0.0.1:29092', kafka.topic = 'sink_debezium', connector = 'kafka', kafka.scan.startup.mode = 'earliest' ) row format debezium_json

statement ok
select * from s;

statement ok
insert into t values (1, 'a'), (2, 'b'), (3, 'c');

statement ok
flush;

query IT rowsort
select v1, v2 from s;
----
1 a
2 b
3 c
