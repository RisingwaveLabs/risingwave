include ../../nexmark/create_sources.slt.part

# Note: It will take a very long time to create all of the NexMark materialized views,
# so we just create stateful queries here
include ../../streaming/nexmark/views/q3.slt.part
include ../../streaming/nexmark/views/q4.slt.part
include ../../streaming/nexmark/views/q5.slt.part
include ../../streaming/nexmark/views/q7.slt.part
include ../../streaming/nexmark/views/q8.slt.part
include ../../streaming/nexmark/views/q9.slt.part
include ../../streaming/nexmark/views/q16.slt.part
include ../../streaming/nexmark/views/q101.slt.part
include ../../streaming/nexmark/views/q102.slt.part
include ../../streaming/nexmark/views/q103.slt.part
include ../../streaming/nexmark/views/q104.slt.part
include ../../streaming/nexmark/views/q105.slt.part


sleep 15s

statement ok
flush;

query I
select count(*) > 0 as has_results from nexmark_q3;
----
t

query I
select count(*) > 0 as has_results from nexmark_q4;
----
t

query I
select count(*) > 0 as has_results from nexmark_q5;
----
t

query I
select count(*) > 0 as has_results from nexmark_q7;
----
t

query I
select count(*) > 0 as has_results from nexmark_q8;
----
t

query I
select count(*) > 0 as has_results from nexmark_q9;
----
t

query I
select count(*) > 0 as has_results from nexmark_q16;
----
t

query I
select count(*) > 0 as has_results from nexmark_q101;
----
t

query I
select count(*) > 0 as has_results from nexmark_q102;
----
t

query I
select count(*) > 0 as has_results from nexmark_q103;
----
t

query I
select count(*) > 0 as has_results from nexmark_q104;
----
t

query I
select count(*) > 0 as has_results from nexmark_q105;
----
t

statement ok
drop materialized view nexmark_q3;

statement ok
drop materialized view nexmark_q4;

statement ok
drop materialized view nexmark_q5;

statement ok
drop materialized view nexmark_q7;

statement ok
drop materialized view nexmark_q8;

statement ok
drop materialized view nexmark_q9;

statement ok
drop materialized view nexmark_q16;

statement ok
drop materialized view nexmark_q101;

statement ok
drop materialized view nexmark_q102;

statement ok
drop materialized view nexmark_q103;

statement ok
drop materialized view nexmark_q104;

statement ok
drop materialized view nexmark_q105;

include ../nexmark/drop_sources.slt.part
