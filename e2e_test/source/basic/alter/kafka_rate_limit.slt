############## Create kafka seed data

statement ok
create table kafka_seed_data (v1 int);

statement ok
insert into kafka_seed_data select * from generate_series(1, 1000);

############## Sink into kafka

statement ok
create sink kafka_sink
from
  kafka_seed_data with (
    properties.bootstrap.server = 'message_queue:29092',
    topic = 'kafka_source',
    type = 'append-only',
    connector = 'kafka'
);

############## Source from kafka (rate_limit = 0)

statement ok
create table kafka_source (v1 int) with (
  connector = 'kafka',
  topic = 'kafka_source',
  properties.bootstrap.server = 'message_queue:29092',
  scan.startup.mode = 'earliest',
  streaming_rate_limit = 0
) FORMAT PLAIN ENCODE JSON

statement ok
flush;

############## Check data

query I
select * from kafka_source;
----
0

############## Alter source (rate_limit = 0 --> rate_limit = 1000)

query I
alter table kafka_source set ('streaming_rate_limit' = '1000');

query I

