
# Create source table.
statement ok
CREATE TABLE s3_test(
    id int,
    name TEXT,
    sex int,
    mark int,
) WITH (
    connector = 's3',
    s3.region_name = '$S3_REGION',
    s3.bucket_name = '$S3_BUCKET',
    s3.credentials.access = '$S3_ACCESS_KEY',
    s3.credentials.secret = '$S3_SECRET_KEY',
    s3.endpoint_url = '$S3_ENDPOINT'
) ROW FORMAT json;

sleep 45s

query I
select count(*), sum(id), sum(sex), sum(mark) from s3_test;
----
$COUNT $SUM_ID $SUM_SEX $SUM_MARK


statement ok
DROP TABLE s3_test;